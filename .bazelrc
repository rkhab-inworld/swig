# Use C++17 standard
build:linux --cxxopt=-std=c++17
build:linux --host_cxxopt=-std=c++17
build:macos --cxxopt=-std=c++17
build:macos --host_cxxopt=-std=c++17
build:windows --cxxopt=/std:c++17
build:windows --host_cxxopt=/std:c++17

# Optimize code.
build:linux --cxxopt=-O3
build:linux --host_cxxopt=-O3
build:macos --cxxopt=-O3
build:macos --host_cxxopt=-O3
build:windows --cxxopt=/O2
build:windows --host_cxxopt=/O2

# Suppress most C++ compiler warnings.
build:linux --host_copt=-w
build:linux --copt="-Wno-all"
build:linux --copt="-Wno-extra"
build:linux --copt="-Wno-deprecated"
build:linux --copt="-Wno-deprecated-declarations"
build:linux --copt="-Wno-ignored-attributes"
build:linux --copt="-Wno-array-bounds"
build:macos --copt=-w
build:windows --copt=/W0
build:windows --host_copt=/W0

# Position independent code.
build:linux --copt=-fPIC
build:macos --copt=-fPIC

### Platform-specific settings ###

# MacOS
common:macos --copt=-mmacosx-version-min=14.0
common:macos --linkopt=-mmacosx-version-min=14.0
common:macos --macos_sdk_version=14.0

# Windows
## Use as little of windows.h as possible
build:windows --copt=-DWIN32_LEAN_AND_MEAN
build:windows --host_copt=-DWIN32_LEAN_AND_MEAN
## Exclude graphics device interface.
build:windows --copt=-DNOGDI
build:windows --host_copt=-DNOGDI

build:windows --extra_toolchains=@local_config_cc//:cc-toolchain-x64_windows-clang-cl
build:windows --platforms=@toolchains//:x64_windows-clang-cl
build:windows --host_platform=@toolchains//:x64_windows-clang-cl
